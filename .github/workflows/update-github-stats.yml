name: Atualizar GitHub Stats e Linguagens (via Metrics)

on:
  # Roda a cada 6 horas (vocÃª pode ajustar esta frequÃªncia)
  schedule:
    - cron: '0 */6 * * *' # min hora dia_do_mes mes dia_da_semana (a cada 6 horas)
  # Roda tambÃ©m quando hÃ¡ um push para a branch principal
  push:
    branches:
      - main # <--- ALtere para 'master' se sua branch principal for 'master'
  # Permite executar o workflow manualmente da aba 'Actions'
  workflow_dispatch:

jobs:
  generate_metrics: # O nome do job mudou para refletir a nova Action
    runs-on: ubuntu-latest
    permissions:
      contents: write # PermissÃ£o necessÃ¡ria para o workflow comitar arquivos no seu repositÃ³rio

    steps:
      # Faz o checkout do seu repositÃ³rio
      - name: Checkout do RepositÃ³rio
        uses: actions/checkout@v4

      # Gera o card de estatÃ­sticas completo com lowlighter/metrics
      - name: Gerar Card de EstatÃ­sticas Completo
        uses: lowlighter/metrics@latest # <--- NOVA ACTION AQUI!
        with:
          token: ${{ secrets.PAT_GITHUB_TOKEN }} # <--- Seu token de acesso pessoal
          filename: profile-assets/github-stats.svg # <--- Caminho onde a imagem serÃ¡ salva
          
          # ConfiguraÃ§Ãµes para o card de estatÃ­sticas
          user: CaioFelipe-Code # Seu nome de usuÃ¡rio do GitHub
          template: classic # Estilo clÃ¡ssico do card
          base: header, activity, community, repositories # Dados bÃ¡sicos a incluir
          
          # Plugins para incluir mais detalhes
          plugin_isocalendar: yes # CalendÃ¡rio de contribuiÃ§Ãµes
          plugin_isocalendar_duration: full-year
          plugin_achievements: yes # Conquistas
          plugin_achievements_secrets: yes # Permite rastrear conquistas secretas (requer PAT)
          plugin_languages: yes # Linguagens mais usadas
          plugin_languages_colors: github # Cores das linguagens
          plugin_languages_ignored: html, css, jupyter notebook, markdown # Linguagens para ignorar
          plugin_languages_limit: 8 # Limite de linguagens a exibir
          plugin_languages_threshold: 0% # Mostrar todas acima de 0% de uso
          plugin_commits: yes # Detalhes de commits
          plugin_topics: yes # TÃ³picos dos repositÃ³rios
          plugin_topics_limit: 5 # Limite de tÃ³picos a exibir
          # Para mais opÃ§Ãµes e plugins, veja a documentaÃ§Ã£o de lowlighter/metrics

      # Configura as informaÃ§Ãµes do committer para o Git
      - name: Configurar InformaÃ§Ãµes do Committer
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"

      # Comita a imagem gerada de volta para o repositÃ³rio
      - name: Comitar e Enviar Imagem Gerada
        run: |
          git add profile-assets/github-stats.svg # Apenas um arquivo SVG agora
          git commit -m "ğŸ“Š Atualizar GitHub Stats com Metrics [skip ci]" || echo "NÃ£o hÃ¡ alteraÃ§Ãµes para comitar"
          git push
